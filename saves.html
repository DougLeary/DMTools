<!DOCTYPE html>
<html lang="en">
<head>
  <title>Saving Throws</title>
  <link rel="stylesheet" href="dnd.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
  <script>
    function selectEdition() {

    }
    
    function roll() {
      const x = $('#howMany')
      console.log(x.innerHTML)
      const edition = $('#edition').val()
      const className = $('#className').val()
      const level = $('#level').val()
      const howMany = $('#howMany').val()

      if (isNaN(level) || isNaN(howMany)) return

      console.log(`Calling api at ./rollsaves/${howMany}/${edition}/${className}/${level}`)
      $.get(`./rollsaves/${howMany}/${edition}/${className}/${level}`, (data) => {
        for (let i=0; i < data.saves.length; i++) {
          $('#saves').append(`${data.saves[i].effect}: ${data.saves[i].need}<br />`)
        }
        for (let n=0; n < howMany; n++) {
          $('#results').append(`Rolled: ${data.rolls[n].roll}, saved: `)
          for (let i=0; i < data.rolls.length; i++) {
            if (i > 0) $('#results').append(', ')
            $('#results').append(`${data.rolls[n].saves[i]}`)
          }
          $('#results').append(`<br />`)
        }
      })
    }
    $(function() {    // document.ready placeholder
    })
   </script></head>
<body>
  <a href="index.html">< Home</a>
  <h1>Saving Throws</h1>
  <p>Rolls multiple saving throws and reports successes and failures. 
  </p>
  <div style="margin:10px; width: 400px; text-align: center;">
    <label for="edition">Book:</label>
    <select name="edition" id="edition" onchange="selectEdition(this.value);">
      <option value="1e">1e Player's Handbook</option>
      <option value="UA">Unearthed Arcana</option>
      <option value="OA">Oriental Adventures</option>
    </select><br />
    <label for="className">Class:</label>
      <select id="className" type="text" onchange="selectClass(this.value);">
        <option value="0"></option>
      </select><br />
    <label for="level">Level:</label>       <input id="level" type="text"></input><br />
    <label for="howMany">How Many:</label>  <input id="howMany" type="text"></input><br />
    <button type="button" onclick="roll()">Roll</button>
  </div>

  <div class="float-container">
    <div class="float-child">
      <div id="saves"></div>
    </div>
    <div class="float-child">
      <div id="results"></div>
    </div>
  </div>
</body>
