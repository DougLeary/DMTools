<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Name Generator-inator</title>
    <link rel="stylesheet" href="dnd.css" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script>
      const current = {type: "", flavor: ""}

      function reloadData() {
        console.log(`Reloading data`)
        $.get(`./names/reload`, (result) => {
          getGenerators()
          $('#results').empty().append("Name generators reloaded.")
        })
      }

      function getGenerators() {
        $('#nameTypes').empty()
        $.get(`./names/types`, (data) => {
          for (let i=0; i < data.length; i++) {
            const type = data[i].type
            const flavor = data[i].flavor || ''
            const st = `<span>${flavor}${(flavor) ? ' ' : ''}${type}</span></br>`
            $('#nameTypes').append(st)
          }
          $('#nameTypes span').addClass('clickable').on('click', clickItem)
        })
      }

      function generateNames(count, type, flavor) {
        $('#results').empty()
        $.get(`./names/${count}/${type}/${flavor}`, (data) => {
          for (let i=0; i < data.length; i++) {
            $('#results').append(`${data[i]}<br/>`)
          }
        })
      }

      function generate() {
        $('#typeHeading').html(current.type.charAt(0).toUpperCase() + current.type.substring(1) + ' names')
        generateNames(10, current.type, current.flavor)
      }

      function clickItem(ev) {    // to do: add count parameter input
        const arr = $(ev.target).text().split(' ')
        if (arr.length > 1) {
          current.type = arr[1]
          current.flavor = arr[0]
        } else {
          current.type = arr[0]
          current.flavor = ""
        }
        generate()
      }

      $(document).ready(getGenerators)
    </script>
    </head>
  <body>
    <a href="index.html">< Home</a>
    <h1>Name Generator-inator</h1>
    <div id="nameTypes" style="margin-bottom:10px">
    </div>
    <h2 id="typeHeading"></h2>
    <div id="results"></div>
    <button style="font-size:14px; width: 60px; height: 40px;" onclick="generate()">Same Again</button>
    <button style="font-size:14px; width: 90px; height: 40px;" onclick="reloadData()">Reload Generators</button>
  </body>
</html>